# enables you to select from the schema without using the predix of the schema name
SET search_path TO hrdays, public;

#fuction to return full name of the employee
CREATE OR REPLACE FUNCTION get_employee_full_name(employee_id INTEGER)
RETURNS TEXT
LANGUAGE sql
IMMUTABLE
AS $$
    SELECT first_name || ' ' || last_name
    FROM employee
    WHERE employee_id = emp_id;
$$;

#function to return the number of years in service
CREATE OR REPLACE FUNCTION get_years_of_service(employee_id INTEGER)
RETURNS INTEGER
LANGUAGE plpgsql
AS $$
DECLARE
    years INTEGER;
BEGIN
    SELECT EXTRACT(YEAR FROM AGE(CURRENT_DATE, hire_date))::INTEGER
    INTO years
    FROM employee
    WHERE employee_id = emp_id;

    RETURN years;
END;
$$;


#using the 2 functions in a select statement 
SELECT 	emp_id, 
		get_employee_full_name(emp_id), 
		get_years_of_service(emp_id)
FROM employee;

