# this function gives a pay rise to employee
# need to provide employee ID and percentage to work

CREATE OR REPLACE FUNCTION give_raise(employee_id INTEGER, percentage NUMERIC)
RETURNS NUMERIC
LANGUAGE plpgsql
AS $$
DECLARE
    new_salary NUMERIC;
BEGIN
    UPDATE employee
    SET salary = salary * (1 + percentage / 100)
    WHERE emp_id = employee_id
    RETURNING salary INTO new_salary;

    IF NOT FOUND THEN
        RAISE EXCEPTION 'Employee with id % not found', emp_id;
    END IF;

    RETURN new_salary;
END;
$$;

# provide the employee id and the percentage through this 
# sql and it will update the record
SELECT give_raise(15, 10);  -- Gives 10% raise to employee 15, returns new salary

